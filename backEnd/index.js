const express = require('express');
const cors = require('cors');
const app = express();
const port = 3000;

app.use(cors());

const dbUrl = 'https://memory-game-project-javascript-default-rtdb.firebaseio.com/';

const food = ['ðŸ', 'ðŸŽ', 'ðŸ', 'ðŸŠ', 'ðŸ‹', 'ðŸŒ', 'ðŸ‰', 'ðŸ‡', 'ðŸ“', 'ðŸˆ', 'ðŸ’', 'ðŸ‘', 'ðŸ', 'ðŸ¥¥', 'ðŸ¥', 'ðŸ…', 'ðŸ¥‘', 'ðŸ†', 'ðŸŒ¶', 'ðŸ¥’', 'ðŸ¥¦', 'ðŸŒ½', 'ðŸ¥•', 'ðŸ¥—', 'ðŸ¥”', 'ðŸ ', 'ðŸ¥œ', 'ðŸ¯', 'ðŸž', 'ðŸ¥', 'ðŸ¥–', 'ðŸ¥¨', 'ðŸ¥ž', 'ðŸ§€', 'ðŸ—', 'ðŸ–', 'ðŸ¥©', 'ðŸ¤', 'ðŸ¥š', 'ðŸ³', 'ðŸ¥“', 'ðŸ”', 'ðŸŸ', 'ðŸŒ­', 'ðŸ•', 'ðŸ', 'ðŸ¥ª', 'ðŸ¥™', 'ðŸŒ®', 'ðŸŒ¯', 'ðŸœ', 'ðŸ¥˜', 'ðŸ²', 'ðŸ¥«', 'ðŸ¥', 'ðŸ£', 'ðŸ±', 'ðŸ›', 'ðŸ™', 'ðŸš', 'ðŸ˜', 'ðŸ¥Ÿ', 'ðŸ¢', 'ðŸ¡', 'ðŸ§', 'ðŸ¨', 'ðŸ¦', 'ðŸ°', 'ðŸŽ‚', 'ðŸ¥§', 'ðŸ®', 'ðŸ­', 'ðŸ¬', 'ðŸ«', 'ðŸ¿', 'ðŸ©', 'ðŸª', 'ðŸ¥ ', 'ðŸµ', 'ðŸ¥£', 'ðŸ¼', 'ðŸ¥¤', 'ðŸ¥›', 'ðŸº', 'ðŸ»', 'ðŸ·', 'ðŸ¥‚', 'ðŸ¥ƒ', 'ðŸ¸', 'ðŸ¹', 'ðŸ¾', 'ðŸ¶', 'ðŸ¥„', 'ðŸ´', 'ðŸ½', 'ðŸ¥¢', 'ðŸ¥¡'];

const flags = ['ðŸ³', 'ðŸ´', 'ðŸ', 'ðŸš©', 'ðŸŽŒ', 'ðŸ´â€â˜ ï¸', 'ðŸ³ï¸â€ðŸŒˆ', 'ðŸ³ï¸â€âš§ï¸', 'ðŸ‡¦ðŸ‡¨', 'ðŸ‡¦ðŸ‡©', 'ðŸ‡¦ðŸ‡ª', 'ðŸ‡¦ðŸ‡«', 'ðŸ‡¦ðŸ‡¬', 'ðŸ‡¦ðŸ‡®', 'ðŸ‡¦ðŸ‡±', 'ðŸ‡¦ðŸ‡²', 'ðŸ‡¦ðŸ‡´', 'ðŸ‡¦ðŸ‡¶', 'ðŸ‡¦ðŸ‡·', 'ðŸ‡¦ðŸ‡¸', 'ðŸ‡¦ðŸ‡¹', 'ðŸ‡¦ðŸ‡º', 'ðŸ‡¦ðŸ‡¼', 'ðŸ‡¦ðŸ‡½', 'ðŸ‡¦ðŸ‡¿', 'ðŸ‡§ðŸ‡¦', 'ðŸ‡§ðŸ‡§', 'ðŸ‡§ðŸ‡©', 'ðŸ‡§ðŸ‡ª', 'ðŸ‡§ðŸ‡«', 'ðŸ‡§ðŸ‡¬', 'ðŸ‡§ðŸ‡­', 'ðŸ‡§ðŸ‡®', 'ðŸ‡§ðŸ‡¯', 'ðŸ‡§ðŸ‡±', 'ðŸ‡§ðŸ‡²', 'ðŸ‡§ðŸ‡³', 'ðŸ‡§ðŸ‡´', 'ðŸ‡§ðŸ‡¶', 'ðŸ‡§ðŸ‡·', 'ðŸ‡§ðŸ‡¸', 'ðŸ‡§ðŸ‡¹', 'ðŸ‡§ðŸ‡¼', 'ðŸ‡§ðŸ‡¾', 'ðŸ‡§ðŸ‡¿', 'ðŸ‡¨ðŸ‡¦', 'ðŸ‡¨ðŸ‡¨', 'ðŸ‡¨ðŸ‡©', 'ðŸ‡¨ðŸ‡«', 'ðŸ‡¨ðŸ‡¬', 'ðŸ‡¨ðŸ‡­', 'ðŸ‡¨ðŸ‡®', 'ðŸ‡¨ðŸ‡°', 'ðŸ‡¨ðŸ‡±', 'ðŸ‡¨ðŸ‡²', 'ðŸ‡¨ðŸ‡³', 'ðŸ‡¨ðŸ‡´', 'ðŸ‡¨ðŸ‡º', 'ðŸ‡¨ðŸ‡»', 'ðŸ‡¨ðŸ‡¼', 'ðŸ‡¨ðŸ‡½', 'ðŸ‡ªðŸ‡¸', 'ðŸ‡ªðŸ‡·', 'ðŸ‡ªðŸ‡­', 'ðŸ‡ªðŸ‡¬', 'ðŸ‡ªðŸ‡ª', 'ðŸ‡ªðŸ‡¨', 'ðŸ‡©ðŸ‡¿', 'ðŸ‡©ðŸ‡´', 'ðŸ‡©ðŸ‡²', 'ðŸ‡©ðŸ‡°', 'ðŸ‡©ðŸ‡¯', 'ðŸ‡©ðŸ‡ª', 'ðŸ‡¨ðŸ‡¿', 'ðŸ‡¨ðŸ‡¾', 'ðŸ‡ªðŸ‡¹', 'ðŸ‡ªðŸ‡º', 'ðŸ‡«ðŸ‡®', 'ðŸ‡«ðŸ‡¯', 'ðŸ‡«ðŸ‡°', 'ðŸ‡«ðŸ‡²', 'ðŸ‡«ðŸ‡´', 'ðŸ‡«ðŸ‡·', 'ðŸ‡¬ðŸ‡¦', 'ðŸ‡¬ðŸ‡§', 'ðŸ‡¬ðŸ‡©', 'ðŸ‡¬ðŸ‡ª', 'ðŸ‡¬ðŸ‡«', 'ðŸ‡¬ðŸ‡¬', 'ðŸ‡¬ðŸ‡­', 'ðŸ‡¬ðŸ‡®', 'ðŸ‡­ðŸ‡º', 'ðŸ‡­ðŸ‡¹', 'ðŸ‡­ðŸ‡·', 'ðŸ‡­ðŸ‡³', 'ðŸ‡­ðŸ‡°', 'ðŸ‡¬ðŸ‡¾', 'ðŸ‡¬ðŸ‡¼', 'ðŸ‡¬ðŸ‡º', 'ðŸ‡¬ðŸ‡¹', 'ðŸ‡¬ðŸ‡¸', 'ðŸ‡¬ðŸ‡·', 'ðŸ‡¬ðŸ‡¶', 'ðŸ‡¬ðŸ‡µ', 'ðŸ‡¬ðŸ‡³', 'ðŸ‡¬ðŸ‡²', 'ðŸ‡¬ðŸ‡±', 'ðŸ‡®ðŸ‡¨', 'ðŸ‡®ðŸ‡©', 'ðŸ‡®ðŸ‡ª', 'ðŸ‡®ðŸ‡±', 'ðŸ‡®ðŸ‡²', 'ðŸ‡®ðŸ‡³', 'ðŸ‡®ðŸ‡´', 'ðŸ‡®ðŸ‡¶', 'ðŸ‡®ðŸ‡·', 'ðŸ‡®ðŸ‡¸', 'ðŸ‡®ðŸ‡¹', 'ðŸ‡¯ðŸ‡ª', 'ðŸ‡¯ðŸ‡²', 'ðŸ‡¯ðŸ‡´', 'ðŸ‡¯ðŸ‡µ', 'ðŸ‡°ðŸ‡ª', 'ðŸ‡±ðŸ‡·', 'ðŸ‡±ðŸ‡°', 'ðŸ‡±ðŸ‡®', 'ðŸ‡±ðŸ‡¨', 'ðŸ‡±ðŸ‡§', 'ðŸ‡±ðŸ‡¦', 'ðŸ‡°ðŸ‡¿', 'ðŸ‡°ðŸ‡¾', 'ðŸ‡°ðŸ‡¼', 'ðŸ‡°ðŸ‡·', 'ðŸ‡°ðŸ‡µ', 'ðŸ‡°ðŸ‡³', 'ðŸ‡°ðŸ‡²', 'ðŸ‡°ðŸ‡®', 'ðŸ‡°ðŸ‡­', 'ðŸ‡°ðŸ‡¬', 'ðŸ‡±ðŸ‡¸', 'ðŸ‡±ðŸ‡¹', 'ðŸ‡±ðŸ‡º', 'ðŸ‡±ðŸ‡»', 'ðŸ‡±ðŸ‡¾', 'ðŸ‡²ðŸ‡¦', 'ðŸ‡²ðŸ‡¨', 'ðŸ‡²ðŸ‡©', 'ðŸ‡²ðŸ‡ª', 'ðŸ‡²ðŸ‡¬', 'ðŸ‡²ðŸ‡­', 'ðŸ‡²ðŸ‡°', 'ðŸ‡²ðŸ‡±', 'ðŸ‡²ðŸ‡²', 'ðŸ‡²ðŸ‡³', 'ðŸ‡²ðŸ‡´', 'ðŸ‡³ðŸ‡¬', 'ðŸ‡³ðŸ‡«', 'ðŸ‡³ðŸ‡ª', 'ðŸ‡³ðŸ‡¨', 'ðŸ‡³ðŸ‡¦', 'ðŸ‡²ðŸ‡¿', 'ðŸ‡²ðŸ‡¾', 'ðŸ‡²ðŸ‡½', 'ðŸ‡²ðŸ‡¼', 'ðŸ‡²ðŸ‡»', 'ðŸ‡²ðŸ‡º', 'ðŸ‡²ðŸ‡¹', 'ðŸ‡²ðŸ‡¸', 'ðŸ‡²ðŸ‡·', 'ðŸ‡²ðŸ‡¶', 'ðŸ‡²ðŸ‡µ', 'ðŸ‡³ðŸ‡®', 'ðŸ‡³ðŸ‡±', 'ðŸ‡³ðŸ‡´', 'ðŸ‡³ðŸ‡µ', 'ðŸ‡³ðŸ‡·', 'ðŸ‡³ðŸ‡º', 'ðŸ‡³ðŸ‡¿', 'ðŸ‡´ðŸ‡²', 'ðŸ‡µðŸ‡¦', 'ðŸ‡µðŸ‡ª', 'ðŸ‡µðŸ‡«', 'ðŸ‡µðŸ‡¬', 'ðŸ‡µðŸ‡­', 'ðŸ‡µðŸ‡°', 'ðŸ‡µðŸ‡±', 'ðŸ‡µðŸ‡²', 'ðŸ‡¸ðŸ‡§', 'ðŸ‡¸ðŸ‡¦', 'ðŸ‡·ðŸ‡¼', 'ðŸ‡·ðŸ‡º', 'ðŸ‡·ðŸ‡¸', 'ðŸ‡·ðŸ‡´', 'ðŸ‡·ðŸ‡ª', 'ðŸ‡¶ðŸ‡¦', 'ðŸ‡µðŸ‡¾', 'ðŸ‡µðŸ‡¼', 'ðŸ‡µðŸ‡¹', 'ðŸ‡µðŸ‡¸', 'ðŸ‡µðŸ‡·', 'ðŸ‡µðŸ‡³', 'ðŸ‡¸ðŸ‡¨', 'ðŸ‡¸ðŸ‡©', 'ðŸ‡¸ðŸ‡ª', 'ðŸ‡¸ðŸ‡¬', 'ðŸ‡¸ðŸ‡­', 'ðŸ‡¸ðŸ‡®', 'ðŸ‡¸ðŸ‡°', 'ðŸ‡¸ðŸ‡±', 'ðŸ‡¸ðŸ‡²', 'ðŸ‡¸ðŸ‡³', 'ðŸ‡¸ðŸ‡´', 'ðŸ‡¸ðŸ‡·', 'ðŸ‡¸ðŸ‡¸', 'ðŸ‡¸ðŸ‡¹', 'ðŸ‡¸ðŸ‡»', 'ðŸ‡¸ðŸ‡½', 'ðŸ‡¹ðŸ‡¹', 'ðŸ‡¹ðŸ‡·', 'ðŸ‡¹ðŸ‡´', 'ðŸ‡¹ðŸ‡³', 'ðŸ‡¹ðŸ‡²', 'ðŸ‡¹ðŸ‡±', 'ðŸ‡¹ðŸ‡°', 'ðŸ‡¹ðŸ‡¯', 'ðŸ‡¹ðŸ‡­', 'ðŸ‡¹ðŸ‡¬', 'ðŸ‡¹ðŸ‡«', 'ðŸ‡¹ðŸ‡©', 'ðŸ‡¹ðŸ‡¨', 'ðŸ‡¹ðŸ‡¦', 'ðŸ‡¸ðŸ‡¿', 'ðŸ‡¸ðŸ‡¾', 'ðŸ‡¹ðŸ‡»', 'ðŸ‡¹ðŸ‡¼', 'ðŸ‡¹ðŸ‡¿', 'ðŸ‡ºðŸ‡¦', 'ðŸ‡ºðŸ‡¬', 'ðŸ‡ºðŸ‡³', 'ðŸ‡ºðŸ‡¸', 'ðŸ‡ºðŸ‡¾', 'ðŸ‡ºðŸ‡¿', 'ðŸ‡»ðŸ‡¦', 'ðŸ‡»ðŸ‡¨', 'ðŸ‡»ðŸ‡ª', 'ðŸ‡»ðŸ‡¬', 'ðŸ‡»ðŸ‡®', 'ðŸ‡»ðŸ‡³', 'ðŸ‡»ðŸ‡º', 'ðŸ‡¿ðŸ‡¼', 'ðŸ‡¿ðŸ‡²', 'ðŸ‡¿ðŸ‡¦', 'ðŸ‡¾ðŸ‡¹', 'ðŸ‡¾ðŸ‡ª', 'ðŸ‡½ðŸ‡°', 'ðŸ‡¼ðŸ‡¸', 'ðŸ‡¼ðŸ‡«'];

const faces = ['ðŸ˜€', 'ðŸ˜¬', 'ðŸ˜', 'ðŸ˜‚', 'ðŸ˜ƒ', 'ðŸ˜„', 'ðŸ¤£', 'ðŸ˜…', 'ðŸ˜†', 'ðŸ˜‡', 'ðŸ˜‰', 'ðŸ˜Š', 'ðŸ™‚', 'ðŸ™ƒ', 'ðŸ˜‹', 'ðŸ˜Œ', 'ðŸ˜', 'ðŸ˜˜', 'ðŸ˜—', 'ðŸ˜™', 'ðŸ˜š', 'ðŸ¤ª', 'ðŸ˜œ', 'ðŸ˜', 'ðŸ˜›', 'ðŸ¤‘', 'ðŸ˜Ž', 'ðŸ¤“', 'ðŸ§', 'ðŸ¤ ', 'ðŸ¤—', 'ðŸ¤¡', 'ðŸ˜', 'ðŸ˜¶', 'ðŸ˜', 'ðŸ˜‘', 'ðŸ˜’', 'ðŸ™„', 'ðŸ¤¨', 'ðŸ¤”', 'ðŸ¤«', 'ðŸ¤­', 'ðŸ¤¥', 'ðŸ˜³', 'ðŸ˜ž', 'ðŸ˜Ÿ', 'ðŸ˜ ', 'ðŸ˜¡', 'ðŸ¤¬', 'ðŸ˜”', 'ðŸ˜•', 'ðŸ™', 'ðŸ˜£', 'ðŸ˜–', 'ðŸ˜«', 'ðŸ˜©', 'ðŸ˜¤', 'ðŸ˜®', 'ðŸ˜±', 'ðŸ˜¨', 'ðŸ˜°', 'ðŸ˜¯', 'ðŸ˜¦', 'ðŸ˜§', 'ðŸ˜¢', 'ðŸ˜¥', 'ðŸ˜ª', 'ðŸ¤¤', 'ðŸ˜“', 'ðŸ˜­', 'ðŸ¤©', 'ðŸ˜µ', 'ðŸ˜²', 'ðŸ¤¯', 'ðŸ¤', 'ðŸ˜·', 'ðŸ¤•', 'ðŸ¤’', 'ðŸ¤®', 'ðŸ¤¢', 'ðŸ¤§', 'ðŸ˜´', 'ðŸ˜ˆ', 'ðŸ‘¿', 'ðŸ‘¹', 'ðŸ‘º', 'ðŸ’©', 'ðŸ‘»', 'ðŸ’€', 'ðŸ‘½', 'ðŸ¤–', 'ðŸŽƒ', 'ðŸ˜º', 'ðŸ˜¸', 'ðŸ˜¹', 'ðŸ˜»', 'ðŸ˜¼', 'ðŸ˜½', 'ðŸ™€', 'ðŸ˜¿', 'ðŸ˜¾'];

const animals = ['ðŸ¦', 'ðŸ£', 'ðŸ¥', 'ðŸ¦“', 'ðŸ¦’', 'ðŸ¦Œ', 'ðŸ', 'ðŸ›', 'ðŸ¦‹', 'ðŸŒ', 'ðŸž', 'ðŸœ', 'ðŸ¦—', 'ðŸ•·', 'ðŸ¦‚', 'ðŸ¢', 'ðŸ', 'ðŸ¦Ž', 'ðŸ¦€', 'ðŸ¦‘', 'ðŸ™', 'ðŸ¦', 'ðŸ ', 'ðŸŸ', 'ðŸ¡', 'ðŸ¬', 'ðŸ¦ˆ', 'ðŸ³', 'ðŸ‹', 'ðŸŠ', 'ðŸ†', 'ðŸ…', 'ðŸƒ', 'ðŸ‚', 'ðŸ„', 'ðŸª', 'ðŸ«', 'ðŸ˜', 'ðŸ¦', 'ðŸ', 'ðŸ', 'ðŸ‘', 'ðŸŽ', 'ðŸ–', 'ðŸ¦‡', 'ðŸ“', 'ðŸ¦ƒ', 'ðŸ•Š', 'ðŸ¦…', 'ðŸ¦†', 'ðŸ¦‰', 'ðŸ•', 'ðŸ©', 'ðŸˆ', 'ðŸ‡', 'ðŸ€', 'ðŸ', 'ðŸ¿', 'ðŸ¦”', 'ðŸ¦•', 'ðŸ¦–'];

const nature = ['ðŸŒµ', 'ðŸŽ„', 'ðŸŒ²', 'ðŸŒ³', 'ðŸŒ´', 'ðŸŒ±', 'ðŸŒ¿', 'ðŸ€', 'ðŸŽ', 'ðŸŽ‹', 'ðŸƒ', 'ðŸ‚', 'ðŸ', 'ðŸŒ¾', 'ðŸŒº', 'ðŸŒ»', 'ðŸŒ¹', 'ðŸ¥€', 'ðŸŒ·', 'ðŸŒ¼', 'ðŸŒ¸', 'ðŸ’', 'ðŸ„', 'ðŸŒ°', 'ðŸš'];

app.get('/cards/:difficulty/:theme', (request, response) => {

    var data = { cards: [] };

    if (request.params !== null) {
        if (request.params.difficulty !== null && request.params.theme !== null) {
            const difficulty = request.params.difficulty;
            const theme = request.params.theme;
            var cards = getCards(difficulty, theme);
            cards.forEach(card => {
                data.cards.push(card);
            });

            cards.forEach(card => {
                data.cards.push(card);
            });

            shuffleArray(data.cards);
        }
    }

    response.send(JSON.stringify(data));
});

app.get('/scores', (request, response) => {
    // https://memory-game-project-javascript-default-rtdb.firebaseio.com/data/scores.json
    console.log(request);
    console.log(request);
    response.send('Scores list!')
});

// app.listen(port, () => {
//     console.log(`Example app listening on port ${port}`);
// });

function randomInteger(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

function getIconIndex(iconIndex, iconList) {

    let newIconIndex = randomInteger(0, (iconList.length - 1));

    if (iconIndex === newIconIndex) {
        return getIconIndex(iconIndex, iconList);
    }
    return newIconIndex;
}

function getCards(difficulty, theme) {
    var cards = [];
    var iconList = null;
    switch (theme) {
        case 'food':
            iconList = food;
            break;
        case 'flags':
            iconList = flags;
            break;
        case 'faces':
            iconList = faces;
            break;
        case 'animals':
            iconList = animals;
            break;
        case 'nature':
            iconList = nature;
            break;
        default:
            iconList = food;
            break;
    }

    for (let i = 0; i < difficulty; i++) {
        var iconIndex = getIconIndex(-1, iconList);
        var card = {
            "isDiscovered": false,
            "icon": iconList[iconIndex],
            "id": iconIndex
        }
        cards.push(card);
    }
    return cards;
}

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

module.exports = app;